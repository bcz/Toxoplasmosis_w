"0",""
"0","## Models and model and model comparison: include outlier"
"0",""
"0","# Null model "
"0","m_null <- brm("
"0","  bf(velocity_cat ~ 1 ),"
"0","  data = d,"
"0","  family = student,"
"0","  chains = 4, iter = 2000, warmup = 1000,"
"0","  cores = 4, seed = 1234,"
"0","  save_pars = save_pars(all = TRUE),"
"0","  backend = ""cmdstanr"","
"0","  file = paste0(root.dir, ""/Results/Output/Model_inc/velocity_m0"")"
"0",")"
"0","#plot(m_null)"
"0","summary(m_null)"
"1"," Family: "
"1","student"
"1"," "
"1","
"
"1","  Links: "
"1","mu = identity; sigma = identity; nu = identity"
"1"," "
"1","
"
"1","Formula: "
"1","velocity_cat ~ 1"
"1"," "
"1","
"
"1","   Data: d (Number of observations: 85) 
"
"1","  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000
"
"1","
"
"1","Regression Coefficients:
"
"1","         "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
Intercept"
"1","     4.56"
"1","      0.21"
"1","     4.13"
"1","     4.96"
"1"," 1.00"
"1","     2842"
"1","     2277"
"1","
"
"1","
"
"1","Further Distributional Parameters:
"
"1","     "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
sigma"
"1","     1.61"
"1","      0.19"
"1","     1.25"
"1","     1.99"
"1"," 1.00"
"1","     2558"
"1","     2938"
"1","
nu   "
"1","     4.67"
"1","      1.83"
"1","     2.21"
"1","     9.08"
"1"," 1.00"
"1","     2541"
"1","     2734"
"1","
"
"1","
"
"1","Draws were sampled using sample(hmc). "
"1","For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1)."
"1","
"
"0","# Line model (line_f)"
"0","m_line <- brm("
"0","  bf(velocity_cat ~ 1 + line_f),"
"0","  data = d,"
"0","  family = student,"
"0","  chains = 4, iter = 2000, warmup = 1000,"
"0","  cores = 4, seed = 1234,"
"0","  save_pars = save_pars(all = TRUE),"
"0","  backend = ""cmdstanr"","
"0","  file = paste0(root.dir, ""/Results/Output/Model_inc/velocity_m1"")"
"0",")"
"0","#plot(m_line)"
"0","summary(m_line)"
"1"," Family: "
"1","student"
"1"," "
"1","
"
"1","  Links: "
"1","mu = identity; sigma = identity; nu = identity"
"1"," "
"1","
"
"1","Formula: "
"1","velocity_cat ~ 1 + line_f"
"1"," "
"1","
"
"1","   Data: d (Number of observations: 85) 
"
"1","  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000
"
"1","
"
"1","Regression Coefficients:
"
"1","               "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
Intercept      "
"1","     5.42"
"1","      0.36"
"1","     4.73"
"1","     6.14"
"1"," 1.00"
"1","     2860"
"1","     2612"
"1","
line_fWT       "
"1","    -1.73"
"1","      0.49"
"1","    -2.69"
"1","    -0.77"
"1"," 1.00"
"1","     3491"
"1","     3037"
"1","
line_fTgTH0    "
"1","    -0.51"
"1","      0.65"
"1","    -1.83"
"1","     0.73"
"1"," 1.00"
"1","     4055"
"1","     3116"
"1","
line_fTgTHMMID "
"1","    -0.07"
"1","      0.58"
"1","    -1.20"
"1","     1.09"
"1"," 1.00"
"1","     3631"
"1","     3038"
"1","
line_fTgTHMHIGH"
"1","    -1.72"
"1","      0.58"
"1","    -2.88"
"1","    -0.63"
"1"," 1.00"
"1","     3542"
"1","     2847"
"1","
"
"1","
"
"1","Further Distributional Parameters:
"
"1","     "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
sigma"
"1","     1.45"
"1","      0.19"
"1","     1.10"
"1","     1.86"
"1"," 1.00"
"1","     3579"
"1","     3183"
"1","
nu   "
"1","     4.45"
"1","      1.88"
"1","     2.04"
"1","     9.15"
"1"," 1.00"
"1","     3882"
"1","     3264"
"1","
"
"1","
"
"1","Draws were sampled using sample(hmc). "
"1","For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1)."
"1","
"
"0","# Sex model (sex_f)"
"0","m_sex <- brm("
"0","  bf(velocity_cat ~ 1 + sex_f),  "
"0","  data = d,"
"0","  family = student,"
"0","  chains = 4, iter = 2000, warmup = 1000,"
"0","  cores = 4, seed = 1234,"
"0","  save_pars = save_pars(all = TRUE),"
"0","  backend = ""cmdstanr"","
"0","  file = paste0(root.dir, ""/Results/Output/Model_inc/velocity_m2"")"
"0",")"
"0","#plot(m_sex)"
"0","summary(m_sex)"
"1"," Family: "
"1","student"
"1"," "
"1","
"
"1","  Links: "
"1","mu = identity; sigma = identity; nu = identity"
"1"," "
"1","
"
"1","Formula: "
"1","velocity_cat ~ 1 + sex_f"
"1"," "
"1","
"
"1","   Data: d (Number of observations: 85) 
"
"1","  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000
"
"1","
"
"1","Regression Coefficients:
"
"1","         "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
Intercept"
"1","     4.25"
"1","      0.31"
"1","     3.62"
"1","     4.85"
"1"," 1.00"
"1","     3270"
"1","     2669"
"1","
sex_f2   "
"1","     0.57"
"1","      0.41"
"1","    -0.25"
"1","     1.39"
"1"," 1.00"
"1","     3858"
"1","     2755"
"1","
"
"1","
"
"1","Further Distributional Parameters:
"
"1","     "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
sigma"
"1","     1.60"
"1","      0.19"
"1","     1.25"
"1","     2.00"
"1"," 1.00"
"1","     3375"
"1","     2714"
"1","
nu   "
"1","     4.75"
"1","      2.00"
"1","     2.23"
"1","     9.85"
"1"," 1.00"
"1","     3587"
"1","     2934"
"1","
"
"1","
"
"1","Draws were sampled using sample(hmc). "
"1","For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1)."
"1","
"
"0","# Line-Sex interaction model (line_f * sex_f)"
"0","m_int <- brm("
"0","  bf(velocity_cat ~ 1 + line_f * sex_f),  "
"0","  data = d,"
"0","  family = student,"
"0","  chains = 4, iter = 2000, warmup = 1000,"
"0","  cores = 4, seed = 1234,"
"0","  save_pars = save_pars(all = TRUE),"
"0","  backend = ""cmdstanr"","
"0","  file = paste0(root.dir, ""/Results/Output/Model_inc/velocity_m3"")"
"0",")"
"0","#plot(m_int)"
"0","summary(m_int)"
"1"," Family: "
"1","student"
"1"," "
"1","
"
"1","  Links: "
"1","mu = identity; sigma = identity; nu = identity"
"1"," "
"1","
"
"1","Formula: "
"1","velocity_cat ~ 1 + line_f * sex_f"
"1"," "
"1","
"
"1","   Data: d (Number of observations: 85) 
"
"1","  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000
"
"1","
"
"1","Regression Coefficients:
"
"1","                      "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
Intercept             "
"1","     5.08"
"1","      0.49"
"1","     4.11"
"1","     6.05"
"1"," 1.00"
"1","     2167"
"1","     2631"
"1","
line_fWT              "
"1","    -1.47"
"1","      0.70"
"1","    -2.84"
"1","    -0.11"
"1"," 1.00"
"1","     2472"
"1","     2614"
"1","
line_fTgTH0           "
"1","    -0.18"
"1","      1.05"
"1","    -2.38"
"1","     1.77"
"1"," 1.00"
"1","     2992"
"1","     2940"
"1","
line_fTgTHMMID        "
"1","     0.13"
"1","      0.87"
"1","    -1.55"
"1","     1.77"
"1"," 1.00"
"1","     2838"
"1","     2634"
"1","
line_fTgTHMHIGH       "
"1","    -2.65"
"1","      0.81"
"1","    -4.22"
"1","    -1.04"
"1"," 1.00"
"1","     2756"
"1","     2732"
"1","
sex_f2                "
"1","     0.68"
"1","      0.72"
"1","    -0.74"
"1","     2.07"
"1"," 1.00"
"1","     1918"
"1","     2476"
"1","
line_fWT:sex_f2       "
"1","    -0.53"
"1","      1.01"
"1","    -2.52"
"1","     1.48"
"1"," 1.00"
"1","     2097"
"1","     2750"
"1","
line_fTgTH0:sex_f2    "
"1","    -0.69"
"1","      1.34"
"1","    -3.26"
"1","     2.03"
"1"," 1.00"
"1","     2621"
"1","     2948"
"1","
line_fTgTHMMID:sex_f2 "
"1","    -0.41"
"1","      1.17"
"1","    -2.72"
"1","     1.83"
"1"," 1.00"
"1","     2452"
"1","     2809"
"1","
line_fTgTHMHIGH:sex_f2"
"1","     1.32"
"1","      1.08"
"1","    -0.79"
"1","     3.40"
"1"," 1.00"
"1","     2298"
"1","     2782"
"1","
"
"1","
"
"1","Further Distributional Parameters:
"
"1","     "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
sigma"
"1","     1.41"
"1","      0.19"
"1","     1.06"
"1","     1.79"
"1"," 1.00"
"1","     3279"
"1","     2787"
"1","
nu   "
"1","     4.23"
"1","      1.85"
"1","     1.95"
"1","     8.85"
"1"," 1.00"
"1","     3842"
"1","     2732"
"1","
"
"1","
"
"1","Draws were sampled using sample(hmc). "
"1","For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1)."
"1","
"
"0","# Line + sex model (line_f + sex_f)"
"0","m_line_sex <- brm("
"0","  bf(velocity_cat ~ 1 + line_f + sex_f),  "
"0","  data = d,"
"0","  family = student,"
"0","  chains = 4, iter = 2000, warmup = 1000,"
"0","  cores = 4, seed = 1234,"
"0","  save_pars = save_pars(all = TRUE),"
"0","  backend = ""cmdstanr"","
"0","  file = paste0(root.dir, ""/Results/Output/Model_inc/velocity_m4"")"
"0",")"
"0","#plot(m_line_sex)"
"0","summary(m_line_sex)"
"1"," Family: "
"1","student"
"1"," "
"1","
"
"1","  Links: "
"1","mu = identity; sigma = identity; nu = identity"
"1"," "
"1","
"
"1","Formula: "
"1","velocity_cat ~ 1 + line_f + sex_f"
"1"," "
"1","
"
"1","   Data: d (Number of observations: 85) 
"
"1","  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000
"
"1","
"
"1","Regression Coefficients:
"
"1","               "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
Intercept      "
"1","     5.11"
"1","      0.39"
"1","     4.35"
"1","     5.85"
"1"," 1.00"
"1","     3928"
"1","     2965"
"1","
line_fWT       "
"1","    -1.73"
"1","      0.51"
"1","    -2.73"
"1","    -0.73"
"1"," 1.00"
"1","     3644"
"1","     3026"
"1","
line_fTgTH0    "
"1","    -0.62"
"1","      0.64"
"1","    -1.90"
"1","     0.62"
"1"," 1.00"
"1","     4145"
"1","     3428"
"1","
line_fTgTHMMID "
"1","    -0.11"
"1","      0.58"
"1","    -1.27"
"1","     1.08"
"1"," 1.00"
"1","     4106"
"1","     2847"
"1","
line_fTgTHMHIGH"
"1","    -1.83"
"1","      0.56"
"1","    -2.92"
"1","    -0.74"
"1"," 1.00"
"1","     4088"
"1","     3333"
"1","
sex_f2         "
"1","     0.64"
"1","      0.38"
"1","    -0.10"
"1","     1.39"
"1"," 1.00"
"1","     5846"
"1","     3063"
"1","
"
"1","
"
"1","Further Distributional Parameters:
"
"1","     "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
sigma"
"1","     1.43"
"1","      0.19"
"1","     1.09"
"1","     1.82"
"1"," 1.00"
"1","     4385"
"1","     3185"
"1","
nu   "
"1","     4.44"
"1","      1.89"
"1","     2.03"
"1","     9.29"
"1"," 1.00"
"1","     4084"
"1","     2669"
"1","
"
"1","
"
"1","Draws were sampled using sample(hmc). "
"1","For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1)."
"1","
"
"0","## Load all models"
"0","m_null <- readRDS(paste0(root.dir, ""/Results/Output/Model_inc/velocity_m0.rds""))"
"0","m_line <- readRDS(paste0(root.dir, ""/Results/Output/Model_inc/velocity_m1.rds""))"
"0","m_sex <- readRDS(paste0(root.dir, ""/Results/Output/Model_inc/velocity_m2.rds""))"
"0","m_int <- readRDS(paste0(root.dir, ""/Results/Output/Model_inc/velocity_m3.rds""))"
"0","m_line_sex <- readRDS(paste0(root.dir, ""/Results/Output/Model_inc/velocity_m4.rds""))"
"0",""
"0","## Compare models and model selection"
"0","m_null <- add_criterion(m_null, ""loo"", moment_match = TRUE) "
"0","m_line <- add_criterion(m_line, ""loo"", moment_match = TRUE) "
"0","m_sex <- add_criterion(m_sex, ""loo"", moment_match = TRUE) "
"0","m_int <- add_criterion(m_int, ""loo"", moment_match = TRUE) "
"0","m_line_sex <- add_criterion(m_line_sex, ""loo"", moment_match = TRUE) "
"0","loo_compare(m_null, m_line, m_sex, m_int, m_line_sex) %>% print(simplify = F)"
"1","          "
"1"," elpd_diff"
"1"," se_diff"
"1"," elpd_loo"
"1"," se_elpd_loo"
"1"," p_loo "
"1"," se_p_loo"
"1"," looic "
"1"," se_looic"
"1","
m_line_sex"
"1","    0.0   "
"1","    0.0 "
"1"," -180.8  "
"1","   12.4     "
"1","   10.0"
"1","    2.9  "
"1","  361.7"
"1","   24.9  "
"1","
m_line    "
"1","   -0.4   "
"1","    1.8 "
"1"," -181.3  "
"1","   12.6     "
"1","    8.9"
"1","    2.9  "
"1","  362.6"
"1","   25.2  "
"1","
m_int     "
"1","   -2.1   "
"1","    2.0 "
"1"," -182.9  "
"1","   12.3     "
"1","   13.9"
"1","    2.8  "
"1","  365.9"
"1","   24.6  "
"1","
m_null    "
"1","   -5.3   "
"1","    4.2 "
"1"," -186.1  "
"1","   12.2     "
"1","    4.5"
"1","    2.4  "
"1","  372.2"
"1","   24.4  "
"1","
m_sex     "
"1","   -5.7   "
"1","    3.9 "
"1"," -186.6  "
"1","   12.4     "
"1","    5.9"
"1","    2.8  "
"1","  373.2"
"1","   24.9  "
"1","
"
"0","# Remove data"
"0","rm(m_null, m_line, m_sex, m_int, m_line_sex)"
"0",""
