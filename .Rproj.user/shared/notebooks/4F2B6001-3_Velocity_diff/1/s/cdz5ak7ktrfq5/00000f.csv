"0",""
"0","## Models and model and model comparison: there are no outliers"
"0",""
"0","# Null model "
"0","m_null <- brm("
"0","  bf(velocity_diff ~ 1),"
"0","  data = d,"
"0","  family = student,"
"0","  chains = 4, iter = 2000, warmup = 1000,"
"0","  cores = 4, seed = 1234,"
"0","  save_pars = save_pars(all = TRUE),"
"0","  backend = ""cmdstanr"","
"0","  file = paste0(root.dir, ""/Results/Output/Model_exc/velocity_diff_m0"")"
"0",")"
"0","#plot(m_null)"
"0","summary(m_null)"
"1"," Family: "
"1","student"
"1"," "
"1","
"
"1","  Links: "
"1","mu = identity; sigma = identity; nu = identity"
"1"," "
"1","
"
"1","Formula: "
"1","velocity_diff ~ 1"
"1"," "
"1","
"
"1","   Data: d (Number of observations: 85) 
"
"1","  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000
"
"1","
"
"1","Regression Coefficients:
"
"1","         "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
Intercept"
"1","     1.43"
"1","      0.29"
"1","     0.86"
"1","     2.02"
"1"," 1.00"
"1","     2528"
"1","     2362"
"1","
"
"1","
"
"1","Further Distributional Parameters:
"
"1","     "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
sigma"
"1","     2.29"
"1","      0.32"
"1","     1.72"
"1","     2.97"
"1"," 1.00"
"1","     2174"
"1","     2316"
"1","
nu   "
"1","     4.76"
"1","      2.81"
"1","     2.06"
"1","    11.71"
"1"," 1.00"
"1","     2369"
"1","     2489"
"1","
"
"1","
"
"1","Draws were sampled using sample(hmc). "
"1","For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1)."
"1","
"
"0","# Line model "
"0","m_line <- brm("
"0","  bf(velocity_diff ~ 1 + line_f),"
"0","  data = d,"
"0","  family = student,"
"0","  chains = 4, iter = 2000, warmup = 1000,"
"0","  cores = 4, seed = 1234,"
"0","  save_pars = save_pars(all = TRUE),"
"0","  backend = ""cmdstanr"","
"0","  file = paste0(root.dir, ""/Results/Output/Model_exc/velocity_diff_m1"")"
"0",")"
"0","#plot(m_line)"
"0","summary(m_line)"
"1"," Family: "
"1","student"
"1"," "
"1","
"
"1","  Links: "
"1","mu = identity; sigma = identity; nu = identity"
"1"," "
"1","
"
"1","Formula: "
"1","velocity_diff ~ 1 + line_f"
"1"," "
"1","
"
"1","   Data: d (Number of observations: 85) 
"
"1","  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000
"
"1","
"
"1","Regression Coefficients:
"
"1","               "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
Intercept      "
"1","     3.31"
"1","      0.54"
"1","     2.25"
"1","     4.41"
"1"," 1.00"
"1","     2155"
"1","     1809"
"1","
line_fWT       "
"1","    -3.47"
"1","      0.78"
"1","    -5.03"
"1","    -2.00"
"1"," 1.00"
"1","     2568"
"1","     2723"
"1","
line_fTgTH0    "
"1","    -1.39"
"1","      0.89"
"1","    -3.19"
"1","     0.36"
"1"," 1.00"
"1","     2974"
"1","     2812"
"1","
line_fTgTHMMID "
"1","    -1.56"
"1","      0.89"
"1","    -3.34"
"1","     0.17"
"1"," 1.00"
"1","     2915"
"1","     2891"
"1","
line_fTgTHMHIGH"
"1","    -2.83"
"1","      0.79"
"1","    -4.41"
"1","    -1.25"
"1"," 1.00"
"1","     2607"
"1","     2501"
"1","
"
"1","
"
"1","Further Distributional Parameters:
"
"1","     "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
sigma"
"1","     2.10"
"1","      0.29"
"1","     1.58"
"1","     2.72"
"1"," 1.00"
"1","     2943"
"1","     2764"
"1","
nu   "
"1","     5.57"
"1","      3.67"
"1","     2.13"
"1","    14.66"
"1"," 1.00"
"1","     3099"
"1","     2742"
"1","
"
"1","
"
"1","Draws were sampled using sample(hmc). "
"1","For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1)."
"1","
"
"0","# Sex model"
"0","m_sex <- brm("
"0","  bf(velocity_diff ~ 1 +  sex_f),  "
"0","  data = d,"
"0","  family = student,"
"0","  chains = 4, iter = 2000, warmup = 1000,"
"0","  cores = 4, seed = 1234,"
"0","  save_pars = save_pars(all = TRUE),"
"0","  backend = ""cmdstanr"","
"0","  file = paste0(root.dir, ""/Results/Output/Model_exc/velocity_diff_m2"")"
"0",")"
"0","#plot(m_sex)"
"0","summary(m_sex)"
"1"," Family: "
"1","student"
"1"," "
"1","
"
"1","  Links: "
"1","mu = identity; sigma = identity; nu = identity"
"1"," "
"1","
"
"1","Formula: "
"1","velocity_diff ~ 1 + sex_f"
"1"," "
"1","
"
"1","   Data: d (Number of observations: 85) 
"
"1","  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000
"
"1","
"
"1","Regression Coefficients:
"
"1","         "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
Intercept"
"1","     1.64"
"1","      0.43"
"1","     0.79"
"1","     2.50"
"1"," 1.00"
"1","     3994"
"1","     2819"
"1","
sex_f2   "
"1","    -0.37"
"1","      0.59"
"1","    -1.59"
"1","     0.75"
"1"," 1.00"
"1","     3821"
"1","     2807"
"1","
"
"1","
"
"1","Further Distributional Parameters:
"
"1","     "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
sigma"
"1","     2.29"
"1","      0.32"
"1","     1.72"
"1","     2.96"
"1"," 1.00"
"1","     2928"
"1","     2502"
"1","
nu   "
"1","     4.73"
"1","      2.60"
"1","     1.98"
"1","    11.09"
"1"," 1.00"
"1","     2991"
"1","     2658"
"1","
"
"1","
"
"1","Draws were sampled using sample(hmc). "
"1","For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1)."
"1","
"
"0","# Sex interaction model"
"0","m_int <- brm("
"0","  bf(velocity_diff ~ 1 + line_f * sex_f),  "
"0","  data = d,"
"0","  family = student,"
"0","  chains = 4, iter = 2000, warmup = 1000,"
"0","  cores = 4, seed = 1234,"
"0","  save_pars = save_pars(all = TRUE),"
"0","  backend = ""cmdstanr"","
"0","  file = paste0(root.dir, ""/Results/Output/Model_exc/velocity_diff_m3"")"
"0",")"
"0","#plot(m_int)"
"0","summary(m_int)"
"1"," Family: "
"1","student"
"1"," "
"1","
"
"1","  Links: "
"1","mu = identity; sigma = identity; nu = identity"
"1"," "
"1","
"
"1","Formula: "
"1","velocity_diff ~ 1 + line_f * sex_f"
"1"," "
"1","
"
"1","   Data: d (Number of observations: 85) 
"
"1","  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000
"
"1","
"
"1","Regression Coefficients:
"
"1","                      "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
Intercept             "
"1","     3.58"
"1","      0.76"
"1","     2.09"
"1","     5.02"
"1"," 1.00"
"1","     1892"
"1","     2611"
"1","
line_fWT              "
"1","    -3.55"
"1","      1.09"
"1","    -5.68"
"1","    -1.34"
"1"," 1.00"
"1","     2575"
"1","     2638"
"1","
line_fTgTH0           "
"1","    -1.38"
"1","      1.29"
"1","    -3.99"
"1","     1.14"
"1"," 1.00"
"1","     2611"
"1","     2811"
"1","
line_fTgTHMMID        "
"1","    -1.47"
"1","      1.32"
"1","    -4.07"
"1","     1.11"
"1"," 1.00"
"1","     2564"
"1","     2460"
"1","
line_fTgTHMHIGH       "
"1","    -3.24"
"1","      1.18"
"1","    -5.52"
"1","    -0.91"
"1"," 1.00"
"1","     2256"
"1","     2878"
"1","
sex_f2                "
"1","    -0.44"
"1","      1.11"
"1","    -2.53"
"1","     1.80"
"1"," 1.00"
"1","     1723"
"1","     2632"
"1","
line_fWT:sex_f2       "
"1","     0.08"
"1","      1.51"
"1","    -2.93"
"1","     2.95"
"1"," 1.00"
"1","     2228"
"1","     2733"
"1","
line_fTgTH0:sex_f2    "
"1","    -0.07"
"1","      1.78"
"1","    -3.56"
"1","     3.45"
"1"," 1.00"
"1","     2330"
"1","     2735"
"1","
line_fTgTHMMID:sex_f2 "
"1","    -0.22"
"1","      1.80"
"1","    -3.78"
"1","     3.26"
"1"," 1.00"
"1","     2190"
"1","     2523"
"1","
line_fTgTHMHIGH:sex_f2"
"1","     0.68"
"1","      1.63"
"1","    -2.58"
"1","     3.88"
"1"," 1.00"
"1","     2009"
"1","     2425"
"1","
"
"1","
"
"1","Further Distributional Parameters:
"
"1","     "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
sigma"
"1","     2.16"
"1","      0.33"
"1","     1.57"
"1","     2.84"
"1"," 1.00"
"1","     2732"
"1","     2732"
"1","
nu   "
"1","     5.76"
"1","      4.15"
"1","     2.12"
"1","    16.69"
"1"," 1.00"
"1","     3011"
"1","     2459"
"1","
"
"1","
"
"1","Draws were sampled using sample(hmc). "
"1","For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1)."
"1","
"
"0","# Line + sex model"
"0","m_line_sex <- brm("
"0","  bf(velocity_diff ~ 1 + line_f + sex_f),  "
"0","  data = d,"
"0","  family = student,"
"0","  chains = 4, iter = 2000, warmup = 1000,"
"0","  cores = 4, seed = 1234,"
"0","  save_pars = save_pars(all = TRUE),"
"0","  backend = ""cmdstanr"","
"0","  file = paste0(root.dir, ""/Results/Output/Model_exc/velocity_diff_m4"")"
"0",")"
"0","#plot(m_line_sex)"
"0","summary(m_line_sex)"
"1"," Family: "
"1","student"
"1"," "
"1","
"
"1","  Links: "
"1","mu = identity; sigma = identity; nu = identity"
"1"," "
"1","
"
"1","Formula: "
"1","velocity_diff ~ 1 + line_f + sex_f"
"1"," "
"1","
"
"1","   Data: d (Number of observations: 85) 
"
"1","  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000
"
"1","
"
"1","Regression Coefficients:
"
"1","               "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
Intercept      "
"1","     3.48"
"1","      0.58"
"1","     2.32"
"1","     4.64"
"1"," 1.00"
"1","     2650"
"1","     2681"
"1","
line_fWT       "
"1","    -3.45"
"1","      0.76"
"1","    -4.99"
"1","    -1.97"
"1"," 1.00"
"1","     2551"
"1","     2682"
"1","
line_fTgTH0    "
"1","    -1.37"
"1","      0.88"
"1","    -3.16"
"1","     0.33"
"1"," 1.00"
"1","     3145"
"1","     2965"
"1","
line_fTgTHMMID "
"1","    -1.56"
"1","      0.88"
"1","    -3.32"
"1","     0.09"
"1"," 1.00"
"1","     2956"
"1","     3098"
"1","
line_fTgTHMHIGH"
"1","    -2.81"
"1","      0.77"
"1","    -4.36"
"1","    -1.32"
"1"," 1.00"
"1","     2605"
"1","     2982"
"1","
sex_f2         "
"1","    -0.34"
"1","      0.54"
"1","    -1.38"
"1","     0.75"
"1"," 1.00"
"1","     4589"
"1","     3344"
"1","
"
"1","
"
"1","Further Distributional Parameters:
"
"1","     "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
sigma"
"1","     2.08"
"1","      0.31"
"1","     1.50"
"1","     2.74"
"1"," 1.00"
"1","     2631"
"1","     2627"
"1","
nu   "
"1","     5.33"
"1","      3.38"
"1","     2.04"
"1","    14.20"
"1"," 1.00"
"1","     2685"
"1","     2714"
"1","
"
"1","
"
"1","Draws were sampled using sample(hmc). "
"1","For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1)."
"1","
"
"0","## Load all models"
"0","m_null <- readRDS(paste0(root.dir, ""/Results/Output/Model_exc/velocity_diff_m0.rds""))"
"0","m_line <- readRDS(paste0(root.dir, ""/Results/Output/Model_exc/velocity_diff_m1.rds""))"
"0","m_sex <- readRDS(paste0(root.dir, ""/Results/Output/Model_exc/velocity_diff_m2.rds""))"
"0","m_int <- readRDS(paste0(root.dir, ""/Results/Output/Model_exc/velocity_diff_m3.rds""))"
"0","m_line_sex <- readRDS(paste0(root.dir, ""/Results/Output/Model_exc/velocity_diff_m4.rds""))"
"0",""
"0","## Compare models and model selection"
"0","m_null <- add_criterion(m_null, ""loo"", moment_match = TRUE) "
"0","m_line <- add_criterion(m_line, ""loo"", moment_match = TRUE) "
"0","m_sex <- add_criterion(m_sex, ""loo"", moment_match = TRUE) "
"0","m_int <- add_criterion(m_int, ""loo"", moment_match = TRUE) "
"0","m_line_sex <- add_criterion(m_line_sex, ""loo"", moment_match = TRUE) "
"0","loo_compare(m_null, m_line, m_sex, m_int, m_line_sex) %>% print(simplify = F)"
"1","          "
"1"," elpd_diff"
"1"," se_diff"
"1"," elpd_loo"
"1"," se_elpd_loo"
"1"," p_loo "
"1"," se_p_loo"
"1"," looic "
"1"," se_looic"
"1","
m_line    "
"1","    0.0   "
"1","    0.0 "
"1"," -208.6  "
"1","   10.6     "
"1","    7.1"
"1","    1.4  "
"1","  417.3"
"1","   21.2  "
"1","
m_line_sex"
"1","   -0.8   "
"1","    0.7 "
"1"," -209.5  "
"1","   10.7     "
"1","    8.3"
"1","    1.5  "
"1","  419.0"
"1","   21.4  "
"1","
m_int     "
"1","   -4.7   "
"1","    0.9 "
"1"," -213.4  "
"1","   10.5     "
"1","   11.5"
"1","    1.5  "
"1","  426.7"
"1","   20.9  "
"1","
m_null    "
"1","   -8.1   "
"1","    4.5 "
"1"," -216.7  "
"1","   10.8     "
"1","    3.5"
"1","    1.2  "
"1","  433.5"
"1","   21.6  "
"1","
m_sex     "
"1","   -8.9   "
"1","    4.5 "
"1"," -217.5  "
"1","   10.8     "
"1","    4.5"
"1","    1.1  "
"1","  435.0"
"1","   21.6  "
"1","
"
"0","# Remove data"
"0","rm(m_null, m_line, m_sex, m_int, m_line_sex)"
"0",""
